import requests
from pygments.lexers import q
import json
from page_configurations import custom_headers
from playwright.sync_api import sync_playwright
proxy_1='98.98.27.108'


url="https://www.davispolk.com/news/ted-polubinski-discusses-securities-class-action-trends-bloomberg-law"

def get_news_article(playwright,start_url):
    browser=playwright.chromium.launch()
    context=browser.new_context(extra_http_headers=custom_headers)
    page=context.new_page()
    page.goto(start_url)
    data=page.locator("script[type='application/ld+json']").text_content()
    json_raw=json.loads(data)
    print(json_raw)
    graph=json_raw.get("@graph", [{}])[0]
    headline=graph.get("headline")
    datePublished=graph.get("datePublished")
    lawyer_section = page.locator('[data-accordion-title="Related lawyers"]')
    toggle_button = lawyer_section.locator("button.accordion__toggle")
    toggle_button.click()
    lawyer_references=lawyer_section.locator("a.link--internal").get_attribute("href")
    print("uwhuwhe")
with sync_playwright() as p:
    get_news_article(p,url)
